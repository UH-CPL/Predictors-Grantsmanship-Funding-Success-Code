}
}
final_data$ti_research<-gsub("[^0-9.-]", "", final_data$ti_research)
final_data$ti_teaching<-gsub("[^0-9.-]", "", final_data$ti_teaching)
final_data$ti_administration<-gsub("[^0-9.-]", "", final_data$ti_administration)
final_data$ti_service_outreach<-gsub("[^0-9.-]", "", final_data$ti_service_outreach)
final_data$proposal_research<-gsub("[^0-9.-]", "", final_data$proposal_research)
final_data$proposal_teaching<-gsub("[^0-9.-]", "", final_data$proposal_teaching)
final_data$proposal_administration<-gsub("[^0-9.-]", "", final_data$proposal_administration)
final_data$proposal_service_outreach<-gsub("[^0-9.-]", "", final_data$proposal_service_outreach)
final_data$week_research<-gsub("[^0-9.-]", "", final_data$week_research)
final_data$week_teaching<-gsub("[^0-9.-]", "", final_data$week_teaching)
final_data$week_administration<-gsub("[^0-9.-]", "", final_data$week_administration)
final_data$week_service_outreach<-gsub("[^0-9.-]", "", final_data$week_service_outreach)
final_data$research<-gsub("[^0-9.-]", "", final_data$research)
final_data$research1<-gsub("[^0-9.-]", "", final_data$research1)
final_data$teaching<-gsub("[^0-9.-]", "", final_data$teaching)
final_data$teaching1<-gsub("[^0-9.-]", "", final_data$teaching1)
final_data$administration<-gsub("[^0-9.-]", "", final_data$administration)
final_data$administration1<-gsub("[^0-9.-]", "", final_data$administration1)
final_data$serviceoutreach<-gsub("[^0-9.-]", "", final_data$serviceoutreach)
final_data$service_outreach1<-gsub("[^0-9.-]", "", final_data$service_outreach1)
final_data$where_you_typically_wor<-toTitleCase(final_data$where_you_typically_wor)
final_data$disrupted_part[1]=5
final_data$disrupted_part[2]=NA
final_data$disrupted_part[3]=NA
final_data$my_physical_activity[2]=5
final_data$my_physical_activity[3]=5
# research_style1 = 'Hands-on [... plus experiments/analysis]'
# research_style2 = 'Hands-off [management/reading/writing]'
#
#
# final_data$test <-
#   case_when(
#     str_detect(final_data$test, research_style1) ~ "Hands-on",
#     str_detect(final_data$test, research_style2) ~
#       "Hands-off"
#   )
# colnames(final_data)
final_data<-final_data  %>%  dplyr::rename(record_id = "ï..record_id")
# final_data <- final_data[-c(89), ]
# # final_data <- final_data[-c(89), ]
final_data <- final_data[rownames(final_data) != "230",]
final_data <- final_data[rownames(final_data) != "288",]
final_data <- final_data[rownames(final_data) != "302",]
final_data <- final_data[rownames(final_data) != "649",]
final_data <- final_data[rownames(final_data) != "662",]
final_data$google_scholar_h_index[97]=18
# factor(final_data$what_is_the_average_number)
# final_data$email <- NULL
final_data$confirm_email <- NULL
final_data$standard_part_complete <- NULL
# colnames(final_data)
final_data$google_scholar_h_index[159] <- NA
final_data$google_scholar_h_index[238] <- NA
final_data$google_scholar_h_index[275] <- NA
final_data$google_scholar_h_index[334] <- NA
final_data$google_scholar_h_index[98] <- 20
final_data$google_scholar_h_index[244] <- NA
final_data$google_scholar_h_index[362] <- 63
final_data$google_scholar_h_index[210] <- NA
final_data$google_scholar_h_index[96] <- 198
final_data$google_scholar_h_index[142] <- NA
final_data$google_scholar_h_index[172] <- NA
final_data$google_scholar_h_index[307] <- NA
final_data$google_scholar_h_index[330] <- 119
final_data$google_scholar_h_index[120] <- 120
final_data$google_scholar_h_index[3] <- 15
final_data$google_scholar_h_index[109] <- 49
final_data$google_scholar_h_index[205] <- NA
final_data$google_scholar_h_index[225] <- 10
final_data$google_scholar_h_index[229] <- NA
final_data$google_scholar_h_index[236] <- 32
final_data<- final_data[,!is.na(final_data$H)]
# final_data<- subset(final_data, final_data$!= "NA")
# final_data<-Standard_data_label[, c(1:80)]
# final_data<-cbind(final_data, Standard_data_index[,c(81:135)])
final_data<-Standard_data_label[, c(1:44)]
final_data<-cbind(final_data, Standard_data_index[,c(45:49)])
final_data<-cbind(final_data, Standard_data_label[,c(50:69)])
final_data<-cbind(final_data, Standard_data_index[,c(70:135)])
for (i in 1:nrow(final_data)) {
# if (final_data$departmental_affiliation[i] == "Other") {
#   final_data$departmental_affiliation[i] = final_data$please_write_down_the_depa[i]
# }
if (final_data$how_many_months_of_your_sa[i] == "Other") {
final_data$how_many_months_of_your_sa[i] = final_data$please_specify_the_months[i]
}
if (final_data$funding_agency[i] == "Other") {
final_data$funding_agency[i] = final_data$specify_the_name[i]
}
if (final_data$where_you_typically_wor[i] == "Other") {
final_data$where_you_typically_wor[i] = final_data$please_specify_your_work_p[i]
}
if (final_data$wha_average_number[i] == "â‰¥ 10") {
final_data$wha_average_number[i] = ">= 10"
}
if (final_data$what_is_the_average_number[i] == "â‰¥ 10") {
final_data$what_is_the_average_number[i] = ">= 10"
}
if (final_data$funding_agency[i] == "Education Advancement Foundation (a private foundation)" | final_data$funding_agency[i] =="Industry, private foundations") {
final_data$funding_agency[i] = "Private Foundation"
}
if (final_data$funding_agency[i] == "trb"){
final_data$funding_agency[i] = "TRB"
}
if (final_data$test[i]=="Hands-on [... plus experiments/analysis]"){
final_data$test[i]="Hands-on"
}else{
final_data$test[i]="Hands-off"
}
}
final_data$ti_research<-gsub("[^0-9.-]", "", final_data$ti_research)
final_data$ti_teaching<-gsub("[^0-9.-]", "", final_data$ti_teaching)
final_data$ti_administration<-gsub("[^0-9.-]", "", final_data$ti_administration)
final_data$ti_service_outreach<-gsub("[^0-9.-]", "", final_data$ti_service_outreach)
final_data$proposal_research<-gsub("[^0-9.-]", "", final_data$proposal_research)
final_data$proposal_teaching<-gsub("[^0-9.-]", "", final_data$proposal_teaching)
final_data$proposal_administration<-gsub("[^0-9.-]", "", final_data$proposal_administration)
final_data$proposal_service_outreach<-gsub("[^0-9.-]", "", final_data$proposal_service_outreach)
final_data$week_research<-gsub("[^0-9.-]", "", final_data$week_research)
final_data$week_teaching<-gsub("[^0-9.-]", "", final_data$week_teaching)
final_data$week_administration<-gsub("[^0-9.-]", "", final_data$week_administration)
final_data$week_service_outreach<-gsub("[^0-9.-]", "", final_data$week_service_outreach)
final_data$research<-gsub("[^0-9.-]", "", final_data$research)
final_data$research1<-gsub("[^0-9.-]", "", final_data$research1)
final_data$teaching<-gsub("[^0-9.-]", "", final_data$teaching)
final_data$teaching1<-gsub("[^0-9.-]", "", final_data$teaching1)
final_data$administration<-gsub("[^0-9.-]", "", final_data$administration)
final_data$administration1<-gsub("[^0-9.-]", "", final_data$administration1)
final_data$serviceoutreach<-gsub("[^0-9.-]", "", final_data$serviceoutreach)
final_data$service_outreach1<-gsub("[^0-9.-]", "", final_data$service_outreach1)
final_data$where_you_typically_wor<-toTitleCase(final_data$where_you_typically_wor)
final_data$disrupted_part[1]=5
final_data$disrupted_part[2]=NA
final_data$disrupted_part[3]=NA
final_data$my_physical_activity[2]=5
final_data$my_physical_activity[3]=5
# research_style1 = 'Hands-on [... plus experiments/analysis]'
# research_style2 = 'Hands-off [management/reading/writing]'
#
#
# final_data$test <-
#   case_when(
#     str_detect(final_data$test, research_style1) ~ "Hands-on",
#     str_detect(final_data$test, research_style2) ~
#       "Hands-off"
#   )
# colnames(final_data)
final_data<-final_data  %>%  dplyr::rename(record_id = "ï..record_id")
# final_data <- final_data[-c(89), ]
# # final_data <- final_data[-c(89), ]
final_data <- final_data[rownames(final_data) != "230",]
final_data <- final_data[rownames(final_data) != "288",]
final_data <- final_data[rownames(final_data) != "302",]
final_data <- final_data[rownames(final_data) != "649",]
final_data <- final_data[rownames(final_data) != "662",]
final_data$google_scholar_h_index[97]=18
# factor(final_data$what_is_the_average_number)
# final_data$email <- NULL
final_data$confirm_email <- NULL
final_data$standard_part_complete <- NULL
# colnames(final_data)
final_data$google_scholar_h_index[159] <- NA
final_data$google_scholar_h_index[238] <- NA
final_data$google_scholar_h_index[275] <- NA
final_data$google_scholar_h_index[334] <- NA
final_data$google_scholar_h_index[98] <- 20
final_data$google_scholar_h_index[244] <- NA
final_data$google_scholar_h_index[362] <- 63
final_data$google_scholar_h_index[210] <- NA
final_data$google_scholar_h_index[96] <- 198
final_data$google_scholar_h_index[142] <- NA
final_data$google_scholar_h_index[172] <- NA
final_data$google_scholar_h_index[307] <- NA
final_data$google_scholar_h_index[330] <- 119
final_data$google_scholar_h_index[120] <- 120
final_data$google_scholar_h_index[3] <- 15
final_data$google_scholar_h_index[109] <- 49
final_data$google_scholar_h_index[205] <- NA
final_data$google_scholar_h_index[225] <- 10
final_data$google_scholar_h_index[229] <- NA
final_data$google_scholar_h_index[236] <- 32
View(final_data)
final_data<- final_data[!is.na(final_data$google_scholar_h_index),]
# final_data<- subset(final_data, final_data$!= "NA")
View(final_data)
final_data<- final_data[final_data$funding_proposal =="No",]
library(dplyr)
library(ggplot2)
library(GGally)
library(reshape2)
library(plyr)
knitr::opts_chunk$set(echo = TRUE)
root_dir <- getwd()
project_directory <- dirname(root_dir)
data_dir <- file.path(project_directory, 'raw-data')
curated_data_dir <- file.path(project_directory, 'curated-data')
plot_dir <- file.path(project_directory, 'Plots')
data_file_name <- 'StandardPart_psychometric.csv'
data_file_name_std <- 'StandardPart.csv'
Data <-
read.csv(file.path(curated_data_dir, data_file_name),
stringsAsFactors = FALSE)
Raw_Data <-
read.csv(file.path(curated_data_dir, data_file_name_std),
stringsAsFactors = FALSE)
colnames(Data) <-
c(
"Rank",
"Mental",
"Physical",
"Temporal",
"Performance",
"Effort",
"Frustration",
"NASA",
"TA",
"EXT",
"AGR",
"CS",
"NT",
"OP",
"AV",
"EM",
"Task"
)
Corelation_DF <-
data.frame(Data[, c(1, 8:17)], Raw_Data[, c(6, 15:17, 22, 26:27, 29:33, 43, 44)])
Corelation_DF <-
Corelation_DF  %>%  dplyr::rename(
H = "google_scholar_h_index",
RS = "test",
## Research Style
WH = "in_a_typical_workday_how_m",
## Typical week working hours
TWR = "ti_research",
FA = "funding_agency",
## Typical week Research
BR = "in_a_typical_day_how_often",
## Break Frequency
NP = "what_is_the_average_number",
## Average Number of Proposal per year
SR = "hy",
## Success Rate in the proposal
AP = "how_far_in_advance_do_you",
# Composing Proposal
AR = "what_is_the_length_of_supp",
## Length of supporting research
DWH = "in_the_week_leading_to_a_p",
## Work load a week before Proposal Deadline
DWR = "week_research",
## Research percentage a week before Proposal
# Research_DD="proposal_research",        ## Research percentage in the Proposal deadlines day
T = "when_you_typically_subm",
## Submit Proposal
DS = "stress_level_in_a_fundi"     ## Stress leven on Proposal Deadline
)
# count(Corelation_DF$Stress_PD)
for (i in 1:nrow(Corelation_DF)) {
#####-------Research Style-------------####################
if (Corelation_DF$RS[i] == "Hands-off") {
Corelation_DF$RS[i] = 1
} else{
Corelation_DF$RS[i] = 2
}
##########-----Typical Week working Hours-------------#############
if (Corelation_DF$WH[i] == "< 30") {
Corelation_DF$WH[i] = 1
} else if (Corelation_DF$WH[i] == "30-40") {
Corelation_DF$WH[i] = 1
} else if (Corelation_DF$WH[i] == "40-50") {
Corelation_DF$WH[i] = 2
} else {
Corelation_DF$WH[i] = 2
}
if (Corelation_DF$BR[i] == "Every hour") {
Corelation_DF$BR[i] = 1
} else if (Corelation_DF$BR[i] == "Every 1-2 hours") {
Corelation_DF$BR[i] = 1
} else if (Corelation_DF$BR[i] == "Every 3-4 hours") {
Corelation_DF$BR[i] = 2
} else {
Corelation_DF$BR[i] = 2
}
if (Corelation_DF$NP[i] == "1-2") {
Corelation_DF$NP[i] = 1
} else if (Corelation_DF$NP[i] == "3-4") {
Corelation_DF$NP[i] = 2
} else if (Corelation_DF$NP[i] == "5-6") {
Corelation_DF$NP[i] = 3
} else if (Corelation_DF$NP[i] == "7-9") {
Corelation_DF$NP[i] = 3
} else if (Corelation_DF$NP[i] == "") {
Corelation_DF$NP[i] = NA
} else {
Corelation_DF$NP[i] = 3
}
if (Corelation_DF$SR[i] == "< 10%") {
Corelation_DF$SR[i] = 0
} else if (Corelation_DF$SR[i] == "10-20%") {
Corelation_DF$SR[i] = 0
} else if (Corelation_DF$SR[i] == "20-30%") {
Corelation_DF$SR[i] = 0
} else if (Corelation_DF$SR[i] == "30-50%") {
Corelation_DF$SR[i] = 1
} else if (Corelation_DF$SR[i] == "50-75%") {
Corelation_DF$SR[i] = 1
} else if (Corelation_DF$SR[i] == "75-90%") {
Corelation_DF$SR[i] = 1
} else if (Corelation_DF$SR[i] == "") {
Corelation_DF$SR[i] = NA
} else {
Corelation_DF$SR[i] = 1
}
# if (Corelation_DF$SR[i] == "< 10%") {
#   Corelation_DF$SR[i] = 1
# } else if (Corelation_DF$SR[i] == "10-20%") {
#   Corelation_DF$SR[i] = 2
# } else if (Corelation_DF$SR[i] == "20-30%") {
#   Corelation_DF$SR[i] = 3
# } else if (Corelation_DF$SR[i] == "30-50%") {
#   Corelation_DF$SR[i] = 4
# } else if (Corelation_DF$SR[i] == "50-75%") {
#   Corelation_DF$SR[i] = 5
# } else if (Corelation_DF$SR[i] == "75-90%") {
#   Corelation_DF$SR[i] = 6
# } else if (Corelation_DF$SR[i] == "") {
#   Corelation_DF$SR[i] = NA
# } else {
#   Corelation_DF$SR[i] = 7
# }
if (Corelation_DF$AP[i] == "1-2 weeks") {
Corelation_DF$AP[i] = 1
} else if (Corelation_DF$AP[i] == "< 1 week") {
Corelation_DF$AP[i] = 1
} else if (Corelation_DF$AP[i] == "2-4 weeks") {
Corelation_DF$AP[i] = 1
} else if (Corelation_DF$AP[i] == "1-2 months") {
Corelation_DF$AP[i] = 2
} else if (Corelation_DF$AP[i] == "") {
Corelation_DF$AP[i] = NA
} else {
Corelation_DF$AP[i] = 2
}
if (Corelation_DF$AR[i] == "< 1 month") {
Corelation_DF$AR[i] = 1
} else if (Corelation_DF$AR[i] == "1-3 months") {
Corelation_DF$AR[i] = 2
} else if (Corelation_DF$AR[i] == "3-6 months") {
Corelation_DF$AR[i] = 3
} else if (Corelation_DF$AR[i] == "6-12 months") {
Corelation_DF$AR[i] = 4
} else if (Corelation_DF$AR[i] == "") {
Corelation_DF$AR[i] = NA
} else {
Corelation_DF$AR[i] = 5
}
if (Corelation_DF$DWH[i] == "Significantly less") {
Corelation_DF$DWH[i] = 1
} else if (Corelation_DF$DWH[i] == "Less") {
Corelation_DF$DWH[i] = 1
} else if (Corelation_DF$DWH[i] == "About the same") {
Corelation_DF$DWH[i] = 1
} else if (Corelation_DF$DWH[i] == "More") {
Corelation_DF$DWH[i] = 2
} else if (Corelation_DF$DWH[i] == "") {
Corelation_DF$DWH[i] = NA
} else {
Corelation_DF$DWH[i] = 2
}
if (Corelation_DF$T[i] == "Minutes before deadline") {
Corelation_DF$T[i] = 1
} else if (Corelation_DF$T[i] == "1-3 hours before deadline") {
Corelation_DF$T[i] = 1
} else if (Corelation_DF$T[i] == "3-6 hours before deadline") {
Corelation_DF$T[i] = 1
} else if (Corelation_DF$T[i] == "1 day before deadline") {
Corelation_DF$T[i] = 2
} else if (Corelation_DF$T[i] == "") {
Corelation_DF$T[i] = NA
} else {
Corelation_DF$T[i] = 2
}
if (Corelation_DF$DS[i] == "Extremely less") {
Corelation_DF$DS[i] = 1
} else if (Corelation_DF$DS[i] == "Significantly less") {
# Corelation_DF$DS[i]=2
Corelation_DF$DS[i] = 1
} else if (Corelation_DF$DS[i] == "Same") {
# Corelation_DF$DS[i]=3
Corelation_DF$DS[i] = 1
} else if (Corelation_DF$DS[i] == "Significantly  more") {
# Corelation_DF$DS[i]=4
Corelation_DF$DS[i] = 2
} else if (Corelation_DF$DS[i] == "Extremely  more") {
# Corelation_DF$DS[i]=5
Corelation_DF$DS[i] = 2
} else {
Corelation_DF$DS[i] = NA
}
if (Corelation_DF$FA[i]=="NSF"){
Corelation_DF$FA[i]=1
} else if (Corelation_DF$FA[i]=="NIH"){
Corelation_DF$FA[i]=2
} else if (Corelation_DF$FA[i]=="DOE"){
Corelation_DF$FA[i]=3
} else if (Corelation_DF$FA[i]=="DOD"){
Corelation_DF$FA[i]=4
} else if (Corelation_DF$FA[i]=="NASA"){
Corelation_DF$FA[i]=5
} else if (Corelation_DF$FA[i]==""){
Corelation_DF$FA[i]=NA
} else{
Corelation_DF$FA[i]=6
}
}
# NSF	NIH	NASA	DOD	DHS	DOE	Other
table(Corelation_DF$SR)
cols.num <-
c("RS", "WH", "BR", "NP", "SR", "AP", "AR", "DWH", "T", "DS", "FA")
Corelation_DF[cols.num] <-
sapply(Corelation_DF[cols.num], as.numeric)
# Corelation_DF <- Corelation_DF[complete.cases(Corelation_DF),]
file_name = 'KeyData.csv'
write.csv(Corelation_DF,
file.path(curated_data_dir, file_name),
row.names = FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(GGally)
library(reshape2)
library(plyr)
library(nnet)
library(MASS)
library(caret)
library(mlbench)
library(rms)
require(tidyr)
library(superml)
library(randomForest)
library(aod)
library(pROC)
# require(dplyr)
# install.packages("aod")
# knitr::opts_chunk$set(echo = TRUE)
#######----Source----------#######
####https://www.youtube.com/watch?v=Z5WKQr4H4Xk
####https://www.youtube.com/watch?v=qkivJzjyHoA
####https://www.analyticsvidhya.com/blog/2016/02/multinomial-ordinal-logistic-regression/
####https://www.youtube.com/watch?v=zE7pVAalmfk&feature=youtu.be&t=424
####http://www.sthda.com/english/articles/38-regression-model-validation/157-cross-validation-essentials-in-r/
# DWH = Workload a week before proposal deadline
# Deviance is a measure of goodness of fit of a model. Higher numbers always indicates bad fit.
# Akaike information criterion (AIC) (Akaike, 1974) is a fined technique based on in-sample fit to estimate the likelihood of a model to predict/estimate the future values. A good model is the one that has minimum AIC among all the other models. ... A lower AIC or BIC value indicates a better fit.
# Forward selection, which starts with no predictors in the model, iteratively adds the most contributive predictors, and stops when the improvement is no longer statistically significant.
#
# Backward selection (or backward elimination), which starts with all predictors in the model (full model), iteratively removes the least contributive predictors, and stops when you have a model where all predictors are statistically significant.
#
# Stepwise selection (or sequential replacement), which is a combination of forward and backward selections. You start with no predictors, then sequentially add the most contributive predictors (like forward selection). After adding each new variable, remove any variables that no longer provide an improvement in the model fit (like backward selection).
root_dir <- getwd()
project_directory <- dirname(root_dir)
data_dir <- file.path(project_directory, 'raw-data')
curated_data_dir <- file.path(project_directory, 'curated-data')
plot_dir <- file.path(project_directory, 'Plots')
data_file_name <- 'KeyData.csv'
data_file_name_std <- 'StandardPart.csv'
Data <-
read.csv(file.path(curated_data_dir, data_file_name),
stringsAsFactors = FALSE)
Data <- Data[complete.cases(Data),]
Data$SR <- as.factor(Data$SR)
hindex = Data$H
lm_DF <- as.data.frame((Data[, 2:25]))
lm_DF$Rank <- as.factor(Data$Rank)
lm_DF$RS <- as.factor(lm_DF$RS)
lm_DF$WH <- as.factor(lm_DF$WH)
lm_DF$NP <- as.factor(lm_DF$NP)
lm_DF$BR <- as.factor(lm_DF$BR)
lm_DF$H <- lm_DF$H + 0.001
lm_DF$H <- log(lm_DF$H)
lm_DF$DWH <- as.factor(lm_DF$DWH)
lm_DF$FA <- as.factor(lm_DF$FA)
lm_DF$T <- as.factor(lm_DF$T)
lm_DF$DS <- as.factor(lm_DF$DS)
lbl <- LabelEncoder$new()
lbl$fit(lm_DF$Rank)
lm_DF$Rank <- lbl$fit_transform(lm_DF$Rank)
lm_DF$Rank <- as.factor(lm_DF$Rank)
# lm_DF$FA <- relevel(lm_DF$FA, ref = "2")
NullModel<-glm(SR~1,data = lm_DF,family="binomial")
summary(NullModel)
# FullModel <- glm(SR ~ Rank+NASA+TA+EXT+AGR+CS+NT+OP+AV+EM+Task+H+RS+WH+TWR+BR+NP+FA+AP+AR+DWH+DWR+T+DS, data = lm_DF, family = "binomial")
FullModel <- glm(SR ~ ., data = lm_DF, family = "binomial")
summary(FullModel)
BEmodel<-stepAIC(FullModel, direction="backward",trace=FALSE)
BEmodel$anova
# summary(BEmodel)
# BEmodel<-stepAIC(FullModel, direction="backward",trace=FALSE)
# BEmodel$anova
summary(BEmodel)
plot(BEmodel)
BEmodel$fitted.values
BEmodel$R
BEmodel$terms
BEmodel$xlevels
BEmodel$qr
BEmodel$family
BEmodel$linear.predictors
BEmodel$deviance
BEmodel$model
